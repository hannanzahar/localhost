<!DOCTYPE html>
<html>
<head>
  <title>Local Host | Fit right in, right away!</title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="">
  <meta content='<%= user_signed_in? ? current_user.id : "" %>' name='user-id'/>

  <script src="//maps.google.com/maps/api/js?v=3.23&sensor=false&client=&key=&libraries=geometry&language=&hl=&region="></script> 
  <script src="//cdn.rawgit.com/mahnunchik/markerclustererplus/master/dist/markerclusterer.min.js"></script>
  <script src='//cdn.rawgit.com/printercu/google-maps-utility-library-v3-read-only/master/infobox/src/infobox_packed.js' type='text/javascript'></script> <!-- only if you need custom infoboxes -->


  <%= javascript_include_tag 'application', 'data-turbolinks-track' => true %>

  <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track' => true %>
  <%= stylesheet_link_tag '//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css' %>
  <!-- Bootstrap core CSS -->
  <!-- <link href="assets/stylesheets/bootstrap.min.css" rel="stylesheet"> -->

  <!-- Custom Google Web Font -->
  <!-- <link href="font-awesome/css/font-awesome.min.css" rel="stylesheet"> -->
  <link href='http://fonts.googleapis.com/css?family=Lato:100,300,400,700,900,100italic,300italic,400italic,700italic,900italic' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Arvo:400,700' rel='stylesheet' type='text/css'>

  <!-- Lobster Font -->
  <link href='https://fonts.googleapis.com/css?family=Lobster' rel='stylesheet' type='text/css'>

  <!-- Modernizr /-->
  <!--[if IE 9]>
    <script src="js/PIE_IE9.js"></script>
    <![endif]-->
  <!--[if lt IE 9]>
    <script src="js/PIE_IE678.js"></script>
    <![endif]-->

  <!--[if lt IE 9]>
    <script src="js/html5shiv.js"></script>
    <![endif]-->

  <%= csrf_meta_tags %>

</head>
<body style="padding-top: 0px">
 
  <%= render partial: "layouts/newnavbar" %>

  <div class="container" style="padding-left: 0px; padding-right: 0px; margin-left: 0px; margin-right: 0px">
    <% if alert %>
    <div class="alert alert-danger" role="alert"><%= alert %></div>
    <% end %>
    <% if notice %>
    <div class="alert alert-success" style="width: 1291px;" role="alert"><%= notice %></div>
    <% end %>
  </div>

    <%= yield %>

    <audio id="chatAudio"><source src="/sounds/notification.mp3" type="audio/mpeg"></audio>

</body>

    <% if current_user %>
    <script type="text/javascript">
      channel = <%= raw ('"' + '/notifications' + current_user.id.to_s + '"') %>
      PrivatePub.subscribe(channel, function(data) {
        var sender_id = data.sid;
        var recipient_id = data.rip;
        var conversation_id = data.cid;
        $.post("/conversations", { sender_id: sender_id, recipient_id: recipient_id }, function (data) {
          chatBox.chatWith(conversation_id);
        });
      });
    </script>
    <%= subscribe_to "/notifications" + current_user.id.to_s %>
    <% end %>

</html>

